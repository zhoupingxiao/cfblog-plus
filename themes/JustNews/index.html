<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width,viewport-fit=cover">
    <title>{{ &title }}</title>
    <meta name="keywords" content="{{ &keyWords }}" />
    <meta name="description" content="{{ &OPT.siteDescription }}" />

    <link rel='stylesheet' id='stylesheet-css' href='{{ &OPT.theme_github_path }}JustNews/files/main.css' type='text/css' media='all' />
    <link rel='stylesheet' id='font-awesome-css' href='{{ &OPT.theme_github_path }}JustNews/files/font-awesome.css?ver=6.1.2' type='text/css' media='all' />
    <link rel='stylesheet' id='wp-block-library-css' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/block-library/style.min.css?ver=5.6' type='text/css' media='all' />
    <link rel='stylesheet' id='wp-components-css' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/components/style.min.css?ver=5.6' type='text/css' media='all' />
    <link rel='stylesheet' id='wp-editor-font-css' href='https://fonts.geekzu.org/css?family=Noto+Serif%3A400%2C400i%2C700%2C700i&#038;ver=5.6' type='text/css' media='all' />
    <link rel='stylesheet' id='wp-block-editor-css' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/block-editor/style.min.css?ver=5.6' type='text/css' media='all' />
    <link rel='stylesheet' id='wp-nux-css' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/nux/style.min.css?ver=5.6' type='text/css' media='all' />
    <link rel='stylesheet' id='wp-editor-css' href='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.5.3/wp-includes/css/dist/editor/style.min.css?ver=5.6' type='text/css' media='all' />
    <link rel='stylesheet' id='mux_video_block_style-css' href='https://cdn.jsdelivr.net/gh/newexsexy/wp@master/wp-content/plugins/ilab-media-tools/public/blocks/mediacloud-mux.blocks.style.min.css' type='text/css' media='all' />

    <link rel='stylesheet' id='emojify-css' href='https://cdn.jsdelivr.net/npm/emojify.js@1.1.0/dist/css/basic/emojify.min.css?ver=1.1.0' type='text/css' media='all' />
    <script type='text/javascript' src='https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/WordPress/WordPress@5.6/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/wpcom-cn/assets/fonts/icons-2.6.4.js?ver=6.1.2' id='wpcom-icons-js'></script>

    {{ &OPT.codeBeforHead }}
</head>
<body class="archive paged category category-zhishi category-5 paged-2 category-paged-2 lang-cn el-boxed">
    <header class="header">
        <div class="container clearfix">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar icon-bar-1"></span>
                    <span class="icon-bar icon-bar-2"></span>
                    <span class="icon-bar icon-bar-3"></span>
                </button>
                <div class="logo">
                    {{ #OPT.logo }}
                    <a href="/" rel="home"><img src="{{ &OPT.logo }}" alt="{{ &OPT.siteName }}"></a>
                    {{ /OPT.logo }}
                    {{ ^OPT.logo }}
                    <a href="/" rel="home"><img src="{{ &OPT.theme_github_path }}JustNews/files/logo2.png" alt="请自定义OPT.logo"></a>
                    {{ /OPT.logo }}
                </div>
            </div>
            <div class="collapse navbar-collapse">
                <nav class="navbar-left primary-menu">
                    <ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav wpcom-adv-menu">
                        {{ #widgetMenuList }}
                        <li class="menu-item"><a href="{{ &url }}">{{ &title }}</a></li>
                        {{ /widgetMenuList }}
                    </ul>
                </nav>
                <div class="navbar-action pull-right">
                    <input type="text" id="search-input" placeholder="搜索文章...">
                    <div id="search-results"></div>
                    <div id="j-user-wrap">
                        <a class="login cur" href="/admin">登录</a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <div id="wrap">
        <div class="container wrap">
            <div class="main">
                <div class="sec-panel sec-panel-default">
                    <div class="sec-panel-body">
                        <ul class="post-loop post-loop-default cols-0">
                            {{ #articleList }}
                            <li class="item" id="post-{{&id}}">
                                <div class="item-img">
                                    <a class="item-img-inner" href="{{ &url }}" title="{{ &title }}" rel="bookmark">
                                        <img width="437" height="300" src="{{ &img }}" class="attachment-post-thumbnail size-post-thumbnail wp-post-image j-lazy" alt="{{ &title }}" title="{{ &title }}" data-original="{{ &img }}" /></a>
                                    {{ #category }}
                                    <a class="item-category" href="/category/{{&.}}">{{&.}}</a>
                                    {{ /category }}
                                </div>
                                <div class="item-content">
                                    <h2 class="item-title">
                                        <a href="{{ &url }}" rel="bookmark">{{ &title }}</a>
                                    </h2>
                                    <div class="item-excerpt">
                                        <p>{{ &contentText }} ...</p>
                                    </div>
                                    <div class="item-meta">
                                        <span class="item-meta-li date">{{ &createDate10 }}</span>
                                        <div class="item-meta-right">
                                            <span class="item-meta-li views" title="阅读数">
                                                <i class="wpcom-icon wi">
                                                    <svg aria-hidden="true">
                                                        <use xlink:href="#wi-eye"></use>
                                                    </svg>
                                                </i>
                                                <span id="{{ &url }}" class="leancloud_visitors">
                                                    <i class="leancloud-visitors-count"></i>
                                                </span>    
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            {{ /articleList }}
                        </ul>
                        <ul class="pagination">
                            {{ #pageNewer }}
                            <li class="prev">
                                <a href="{{ &url }}" class="prev">
                                    <i class="wpcom-icon wi">
                                        <svg aria-hidden="true"><use xlink:href="#wi-arrow-left"></use></svg>
                                    </i>
                                    <span>上一页</span>
                                </a>
                            </li>
                            {{ /pageNewer }}
                            {{ #pageOlder }}
                            <li class="next">
                                <a href="{{ &url }}" class="next">
                                    <span>下一页</span>
                                    <i class="wpcom-icon wi">
                                        <svg aria-hidden="true"><use xlink:href="#wi-arrow-right"></use></svg>
                                    </i>
                                </a>
                            </li>
                            {{ /pageOlder }}
                        </ul>
                    </div>
                </div>
            </div>
            <aside class="sidebar">
                <div id="wpcom-post-thumb-2" class="widget widget_post_thumb">
                    <h3 class="widget-title">
                        <span>近期文章</span>
                    </h3>
                    <ul>
                        {{ #widgetRecentlyList }}
                        <li class="item">
                            <div class="item-img">
                                <a class="item-img-inner" href="{{ &url }}" title="{{ &title }}" rel="bookmark">
                                    <img width="200" height="133" src="{{ &img }}" class="attachment-post-thumbnail size-post-thumbnail wp-post-image j-lazy" alt="{{ &title }}" title="{{ &title }}" data-original="{{ &img }}" />
                                </a>
                            </div>
                            <div class="item-content">
                                <h2 class="item-title">
                                    <a href="{{ &url }}" rel="bookmark">{{ &title }}</a>
                                </h2>
                                <div class="item-meta">
                                    <span class="item-meta-li date">{{ &createDate10 }}</span>
                                </div>
                            </div>
                        </li>
                        {{ /widgetRecentlyList }}
                    </ul>
                </div>
            </aside>
        </div>
    </div>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr/lunr.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 获取文章数据
            const articles = {{ &articleList | json }};
            
            // 初始化 Lunr.js
            const idx = lunr(function () {
                this.ref('id');
                this.field('title');
                this.field('contentText');
                
                articles.forEach(article => {
                    this.add(article);
                });
            });

            // 搜索输入框事件
            const searchInput = document.getElementById('search-input');
            const searchResults = document.getElementById('search-results');

            searchInput.addEventListener('input', function () {
                const query = searchInput.value.trim();
                searchResults.innerHTML = '';

                if (query) {
                    const results = idx.search(query);
                    if (results.length > 0) {
                        results.forEach(result => {
                            const article = articles.find(a => a.id === result.ref);
                            const resultItem = document.createElement('div');
                            resultItem.innerHTML = `<a href="${article.url}">${article.title}</a>`;
                            searchResults.appendChild(resultItem);
                        });
                    } else {
                        searchResults.innerHTML = '<p>未找到匹配的文章。</p>';
                    }
                }
            });
        });
    </script>
</body>
</html>
